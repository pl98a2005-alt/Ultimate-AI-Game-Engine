name: GENERATE_MASTER_ARCHITECT_APK
on: [push]

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9'

      - name: Install Pure Core Tools
        run: |
          sudo apt-get update
          # ØªØ«Ø¨ÙŠØª Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø· Ù„ØªØ¬Ù†Ø¨ ØªØ¹Ø§Ø±Ø¶ Ø§Ù„Ø­Ø²Ù…
          sudo apt-get install -y build-essential git python3-dev zip unzip
          pip install --user --upgrade Cython==0.29.33 buildozer virtualenv

      - name: Inject AI Architect Brain
        run: |
          rm -f buildozer.spec
          # Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ (Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ©)
          echo "
          from kivy.app import App
          from kivy.uix.boxlayout import BoxLayout
          from kivy.uix.textinput import TextInput
          from kivy.uix.button import Button
          from kivy.uix.label import Label
          from kivy.core.window import Window

          class ArchitectApp(App):
              def build(self):
                  Window.clearcolor = (0, 0, 0, 1)
                  layout = BoxLayout(orientation='vertical', padding=20, spacing=10)
                  layout.add_widget(Label(text='ğŸ‘‘ Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ø§Ù„Ø°ÙƒÙŠ - AI Architect', font_size='24sp', color=(1, 0.8, 0, 1)))
                  self.input = TextInput(hint_text='Ø§Ø¯Ù…Ø¬ Ø¨Ø¨Ø¬ÙŠ ÙˆÙƒÙˆØ¯... ØµÙ Ù„Ø¹Ø¨ØªÙƒ Ù‡Ù†Ø§', multiline=True, background_color=(0.1, 0.1, 0.1, 1), foreground_color=(1, 1, 1, 1))
                  layout.add_widget(self.input)
                  layout.add_widget(Button(text='Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬', size_hint_y=0.2, background_color=(0, 0.4, 0.7, 1)))
                  return layout
          ArchitectApp().run()
          " > main.py
          
          # Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù€ APK Ø§Ù„Ù…Ù„Ù…ÙˆØ³
          /home/runner/.local/bin/buildozer init
          sed -i 's/title = .*/title = AI Architect/' buildozer.spec
          sed -i 's/package.name = .*/package.name = sovereign.ai.builder/' buildozer.spec
          sed -i 's/requirements = .*/requirements = python3,kivy/' buildozer.spec
          sed -i 's/# android.accept_sdk_license = .*/android.accept_sdk_license = True/' buildozer.spec
          # ØªÙ‚Ù„ÙŠÙ„ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù„ØªØ³Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙˆÙ…Ù†Ø¹ Ø§Ù„Ø§Ø®ØªÙ†Ø§Ù‚
          sed -i 's/# log_level = .*/log_level = 1/' buildozer.spec

      - name: Build Official APK
        run: |
          export APP_ANDROID_ACCEPT_SDK_LICENSE=1
          /home/runner/.local/bin/buildozer -v android debug

      - name: Deliver Your APK
        uses: actions/upload-artifact@v4
        with:
          name: AI-Architect-Ready
          path: bin/*.apk
